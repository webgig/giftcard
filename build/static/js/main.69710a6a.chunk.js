(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,a){e.exports=a(36)},28:function(e,t,a){},29:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},30:function(e,t,a){},36:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(17),c=a.n(s),o=(a(27),a(28),a(7)),i=a(8),l=a(11),u=a(9),m=a(10),d=(a(29),a(30),a(2)),h=a.n(d),p=a(4),f=a(18),v=a(13),b="http://localhost:8000/api",g=function(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.token?{Authorization:"Token "+e.token,"Content-Type":"application/json"}:{}},w=function(){var e=Object(p.a)(h.a.mark(function e(t){var a,n,r;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.text();case 2:if(a=e.sent,n=a&&JSON.parse(a),t.ok){e.next=8;break}return 401===t.status&&(E.logout(),window.location.reload(!0)),r=n&&n.non_field_errors||t.statusText,e.abrupt("return",Promise.reject(r));case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),E={login:function(){var e=Object(p.a)(h.a.mark(function e(t,a){var n,r,s;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:a})},e.next=3,fetch("".concat(b,"/auth/"),n);case 3:return r=e.sent,e.next=6,w(r);case 6:return(s=e.sent)&&localStorage.setItem("user",JSON.stringify(s)),e.abrupt("return",s);case 9:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),logout:function(){localStorage.removeItem("user")},getMe:function(){var e=Object(p.a)(h.a.mark(function e(){var t,a;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=JSON.parse(localStorage.getItem("user")))||!t.user_id){e.next=4;break}return a={method:"GET",headers:g()},e.abrupt("return",fetch("".concat(b,"/users/")+t.user_id+"/",a).then(w));case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},y=function(e){function t(e){var a;return Object(o.a)(this,t),a=Object(l.a)(this,Object(u.a)(t).call(this,e)),E.logout(),a.state={username:"",password:"",submitted:!1,loading:!1,error:""},a.handleChange=a.handleChange.bind(Object(v.a)(Object(v.a)(a))),a.handleLogin=a.handleLogin.bind(Object(v.a)(Object(v.a)(a))),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(f.a)({},a,n))}},{key:"handleLogin",value:function(){var e=Object(p.a)(h.a.mark(function e(t){var a,n,r,s=this;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),this.setState({submitted:!0}),a=this.state,n=a.username,r=a.password,a.returnUrl,n&&r){e.next=5;break}return e.abrupt("return");case 5:this.setState({loading:!0}),E.login(n,r).then(function(e){console.log(e);var t=(s.props.location.state||{from:{pathname:"/"}}).from;s.props.history.push(t)},function(e){return s.setState({error:e,loading:!1})});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=(e.username,e.password,e.submitted,e.loading,e.error);return r.a.createElement("form",{className:"form-signin text-center",onSubmit:this.handleLogin},r.a.createElement("h2",null,"Prezzee"),t&&r.a.createElement("div",{className:"alert alert-danger"},t),r.a.createElement("h1",{className:"h3 mb-3 font-weight-normal"},"Please sign in"),r.a.createElement("label",{htmlFor:"inputEmail",className:"sr-only"},"Email address"),r.a.createElement("input",{name:"username",type:"text",id:"inputEmail",className:"form-control",placeholder:"Email address",required:!0,autoFocus:!0,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"inputPassword",value:"sagar123",className:"sr-only"},"Password"),r.a.createElement("input",{name:"password",type:"password",id:"inputPassword",className:"form-control",placeholder:"Password",required:!0,onChange:this.handleChange}),r.a.createElement("button",{className:"btn btn-lg btn-primary btn-block",type:"submit"},"Sign in"))}}]),t}(n.Component),O=a(20),j=a(40),k=a(38),x=function(e){var t=e.component,a=Object(O.a)(e,["component"]);return r.a.createElement(j.a,Object.assign({},a,{render:function(e){return localStorage.getItem("user")?r.a.createElement(t,e):r.a.createElement(k.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},N=a(39),S=a(37),C={getMyCards:function(){var e=Object(p.a)(h.a.mark(function e(){var t,a;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=JSON.parse(localStorage.getItem("user")))||!t.user_id){e.next=4;break}return a={method:"GET",headers:g()},e.abrupt("return",fetch("".concat(b,"/users/")+t.user_id+"/cards/",a).then(w));case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),archive:function(){var e=Object(p.a)(h.a.mark(function e(t,a){var n;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return n={method:"PATCH",headers:g(),body:JSON.stringify({archived:a})},e.next=4,fetch("".concat(b,"/cards/")+t+"/",n).then(w);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}()},P=a(19),J=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={archived:!1,cards:[]},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"showArchived",value:function(){var e=!1;e=!this.state.archived,this.setState({archived:e})}},{key:"archive",value:function(){var e=Object(p.a)(h.a.mark(function e(t,a){var n,r;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(P.a)(this.state.cards),r=n.findIndex(function(e){return e.id==t}),e.next=4,C.archive(a.id,!a.archived);case 4:n[r]=e.sent,this.setState({cards:n});case 6:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(e){this.setState({cards:e.cards})}},{key:"render",value:function(){var e=this,t=this.state.cards.filter(function(t){return t.archived==e.state.archived});return r.a.createElement("div",{className:"container"},r.a.createElement("button",{type:"button",className:"btn btn-primary my-2","data-toggle":"button","aria-pressed":"false",onClick:this.showArchived.bind(this)}," View Archived Cards"),t.length>0&&r.a.createElement("div",{className:"row"},t.map(function(t,a){return r.a.createElement("div",{className:"col-md-4",key:a},r.a.createElement("div",{className:"card mb-4 shadow-sm"},r.a.createElement("svg",{className:"bd-placeholder-img card-img-top",width:"100%",height:"225",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid slice",focusable:"false",role:"img","aria-label":"Placeholder: Thumbnail"},r.a.createElement("rect",{width:"100%",height:"100%",fill:"#55595c"}),r.a.createElement("text",{x:"40%",y:"50%",fill:"#eceeef",dy:".3em"},t.title)),r.a.createElement("div",{className:"card-body"},e.state.archived&&r.a.createElement("h6",null,r.a.createElement("span",{className:"badge badge-secondary"},"Archived")),r.a.createElement("div",{className:"card-text"},r.a.createElement("p",null,t.description),r.a.createElement("small",null,r.a.createElement("strong",null,"AUD  ",t.value))),r.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},r.a.createElement("div",{className:"btn-group"},r.a.createElement("button",{onClick:e.archive.bind(e,t.id,t),type:"button",className:"btn btn-sm btn-outline-secondary"},e.state.archived?"Unarchive":"Archive")),r.a.createElement("small",{className:"text-muted"},r.a.createElement("strong",null,"Voucher")," ",t.voucher),r.a.createElement("small",{className:"text-muted"},r.a.createElement("strong",null,"Pin"),t.voucher)))))})))}}]),t}(n.Component),A=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={user:{},cards:[]},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(p.a)(h.a.mark(function e(){var t,a;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({user:JSON.parse(localStorage.getItem("user"))}),e.next=3,E.getMe();case 3:return t=e.sent,e.next=6,C.getMyCards();case 6:a=e.sent,this.setState({user:t,cards:a});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.user,a=e.cards;return r.a.createElement("div",null,r.a.createElement("header",{className:"navbar navbar-dark bg-dark shadow-sm"},r.a.createElement("div",{className:"container d-flex justify-content-between"},r.a.createElement("a",{href:"#",className:"navbar-brand d-flex align-items-center"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2","aria-hidden":"true",className:"mr-2",viewBox:"0 0 24 24",focusable:"false"},r.a.createElement("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.a.createElement("circle",{cx:"12",cy:"13",r:"4"})),r.a.createElement("strong",null,"Prezzee")),t.username&&r.a.createElement("strong",null,"Hi ",t.first_name),r.a.createElement(S.a,{to:"/login"},"Logout"))),r.a.createElement("div",{className:"album py-5 bg-light"},r.a.createElement(J,{param:"test",cards:a})))}}]),t}(r.a.Component),I=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(N.a,null,r.a.createElement("div",null,r.a.createElement(x,{exact:!0,path:"/",component:A}),r.a.createElement(j.a,{path:"/login",component:y})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[21,1,2]]]);
//# sourceMappingURL=main.69710a6a.chunk.js.map